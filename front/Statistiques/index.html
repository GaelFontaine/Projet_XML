<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
        <meta charset="utf-8">
        <title>Statistics data</title>
        <link type="text/css" rel="stylesheet" href="./style.css">
        <link type="text/css" rel="stylesheet" href="./statistics.css">
    </head>
    <body>
        <div id="menu">
            <ul>
                <li>
                      <a href="../Projets/projet.html">Les Projets</a>
                </li>
                <li>
                    <a>Les Centres</a>
                    <div></div>
                    <ul id="secondlist">
                        <li>CRI Bordeaux</li>
                        <li>CRI Grenoble</li>
                        <li>CRI Lille</li>
                        <li>CRI Nancy</li>
                        <li>CRI Paris</li>
                        <li>CRI Rennes</li>
                        <li>CRI Sophia Antipolis</li>
                        <li>CRI Saclay</li>
                    </ul>
                </li>
                <li>
                    <a>Statistique</a>
                </li>
                <li>
                    <a>Contact</a>
                </li>
                <li>
                    <a>About Us</a>
                </li>
            </ul>
        </div>

        <div class="content-item">
            <div class="content ct-chart">
                <h1>Team number by research center</h1>
            </div>

        </div>
        <link href="chartist.css" rel="stylesheet" type="text/css">
        <script src='chartist.js'></script>

        <script>
            var dataToInsert = new Array();
            var data = []
            fetch('http://localhost:9080/stat/nbequipe-par-centre').then(function(response) {
                        response.json().then(function(data) {
                            for(var i = 0; i<data.length; i++){
                                // On récupère les occurence pour chaque centre (le nombre d'équipes pour le centre à l'indice [i]
                                dataToInsert[i] = data[i].occurence;
                            }
                        });

                    })
            new Chartist.Bar('.ct-chart', {
                labels: ["Bordeaux", "Grenoble", "Lille", "Nancy", "Paris", "Rennes", "Sophia Antipolis", "Saclay"],
                series: [dataToInsert[0], dataToInsert[1], dataToInsert[2], dataToInsert[3], dataToInsert[4], dataToInsert[5], dataToInsert[6], dataToInsert[7]]
            }, {
                height: '300px',
                distributeSeries: true
            });
        </script>

        <div class="content-item">
            <div class="content ct-chart2">
                <h1>Nombre de personnes par centre</h1>
            </div>

        </div>
        <link href="chartist.css" rel="stylesheet" type="text/css">
        <script src='chartist.js'></script>

        <script>
            var dataToInsert = new Array();
            var data = []
            fetch('http://localhost:9080/stat/nbpers-par-centre').then(function(response) {
                response.json().then(function(data) {
                    for(var i = 0; i<data.length; i++){
                        // On récupère les occurence pour chaque centre (le nombre de personne pour le centre à l'indice [i]
                        dataToInsert[i] = data[i].occurence;
                    }
                });

            })
            var total = dataToInsert[0] + dataToInsert[1] + dataToInsert[2] + dataToInsert[3] + dataToInsert[4] + dataToInsert[5] + dataToInsert[6] + dataToInsert[7];
            // label externe
            var data = {
                // récupérer depuis bd
                labels: ['Bordeaux', 'Grenoble', 'Lille', 'Nancy', 'Paris', 'Rennes', 'Sophia Antipolis', 'Saclay'],
                series: [100*(dataToInsert[0]/total), 100*(dataToInsert[1]/total), 100*(dataToInsert[2]/total), 100*(dataToInsert[3]/total), 100*(dataToInsert[4]/total), 100*(dataToInsert[5]/total), 100*(dataToInsert[6]/total), 100*(dataToInsert[7]/total)]
            };

            var options = {
                labelInterpolationFnc: function(value) {
                    return value[0]
                }
            };

            var responsiveOptions = [
                ['screen and (min-width: 640px)', {
                    chartPadding: 30,
                    labelOffset: 100,
                    labelDirection: 'explode',
                    labelInterpolationFnc: function(value) {
                        return value;
                    }
                }],
                ['screen and (min-width: 1024px)', {
                    labelOffset: 80,
                    chartPadding: 20
                }]
            ];
            new Chartist.Pie('.ct-chart2', data, options, responsiveOptions);
        </script>

</body>
</html>